<template>
    <lightning-card>
        <div class="SE-mainBody">
            <div class="SE-content">
                <div class="SE-top">
                    <div class="SE-linkLable">
                        Maintain State Attorney Inspector
                    </div>
                </div>
                <div class="SE-Card firstDivForSearching">
                    <div class="SE-searchCardHeader searchTitleHeader">
                        <div class="SE-searchCardHeaderIcon">
                            <lightning-icon icon-name="standard:search" size="medium"></lightning-icon>
                        </div>
                        <div class="SE-searchCardHeaderTitle">
                            <div class="SE-searchCardHeaderTitleText">
                                Search
                            </div>
                        </div>
                    </div>
                    <div class="SE-searchCardContent searchInputFieldsAndComboboxContainer">
                        <div>
                            <lightning-layout>
                                <lightning-layout-item style="flex-basis: 20%;" size="2" class="slds-p-right_medium">
                                    <lightning-input class="SE-searchCardInputLabel" label="Last Name" id="LastName"
                                        type="text" value={lastName} pattern="[A-Za-z]+" message-when-pattern-mismatch="Last name should only contain letters." onchange={handleLastNameChange}
                                        placeholder="e.g Doe">
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item style="flex-basis: 20%;" size="2" class="slds-p-right_medium">
                                    <lightning-input class="SE-searchCardInputLabel" label="First Name" id="FirstName"
                                        type="text" value={firstName} pattern="[A-Za-z]+" message-when-pattern-mismatch="First name should only contain letters." onchange={handleFirstNameChange}
                                        placeholder="e.g John">
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item style="flex-basis: 20%;" size="2" class="slds-p-right_medium">
                                    <lightning-input class="SE-searchCardInputLabel" label="Middle Name" id="MiddleName"
                                        type="text" value={middleName} pattern="[A-Za-z]+" message-when-pattern-mismatch="Middle name should only contain letters." onchange={handleMiddleNameChange}
                                        placeholder="e.g R">
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item style="flex-basis: 20%;" size="2" class="slds-p-right_medium">
                                    <lightning-input class="SE-searchCardInputLabel"
                                    name = "phone"  
                                    label="Phone Number"
                                    id="Phone"
                                    type="tel" 
                                    value={phoneNumber} 
                                    maxlength="14"
                                    onchange={handlePhoneNumberChange}
                                    onkeydown={handlePhoneKeyDown}
                                    placeholder="e.g (123) 456-7890">
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item style="flex-basis: 20%;" size="2" class="slds-p-right_medium">    
                                </lightning-layout-item>
                            </lightning-layout>
                        </div>

                    </div>
                    <div class="SE-footer">
                        <div class="button-group">
                            <div class="clear-all" onclick={handleClear}>
                                <span class="clear-icon-wrapper">
                                    <lightning-icon icon-name="utility:close" size="xx-small"
                                        class="clear-icon"></lightning-icon>
                                </span>
                                <span class="clear-text">Clear All</span>
                            </div>
                            <lightning-button icon-name="utility:search" variant="brand" alternative-text="Search"
                                label="Search" onclick={handleSearch} title="Search" class="customButton">
                            </lightning-button>
                        </div>
                    </div>
                </div>
                <template if:true={isLoading}>
                    <div class="spinner-container">
                        <lightning-spinner alternative-text="Loading..." variant="brand" size="large"></lightning-spinner>
                    </div>
                </template>
                <template if:false={isLoading}>
                    <div class="SE-Card SE-searchCardContent secondDivForDataTable">
                        <div class="slds-grid slds-grid_align-end ">
                            <div class="buttoncontainerfilter">
    
                                <div class="left-button ">
                                    <span class="slds-text-title_bold slds-m-right_x-small">Search Result:</span>
                                    <lightning-badge label={recordCountValue} class="totoalcountbadge">
                                    </lightning-badge>
                                </div>
    
                                <div class="right-buttons">
                                    <lightning-badge data-id="today" label="Today" class={badgeClassCurrentDay}
                                        onclick={handleBadgeClick}>
                                    </lightning-badge>
                                    <lightning-badge data-id="this-week" label="This Week" class={badgeClassThisWeek}
                                        onclick={handleBadgeClick}>
                                    </lightning-badge>
                                    <lightning-badge data-id="this-month" label="This Month" class={badgeClassThisMonth}
                                        onclick={handleBadgeClick}>
                                    </lightning-badge>
                                    <lightning-badge data-id="this-quarter" label="This Quarter"
                                        class={badgeClassThisQuarter} onclick={handleBadgeClick}>
                                    </lightning-badge>
                                    <lightning-badge data-id="this-year" label="This Year" class={badgeClassThisYear}
                                        onclick={handleBadgeClick}>
                                    </lightning-badge>
    
                                    <lightning-button label="Add New State Attorney Inspector" icon-name="utility:add"
                                        onclick={openAddModal} variant="brand" class="customButton">
                                    </lightning-button>
    
                                </div>
                            </div>
                        </div>
                        <template if:true={recordCount}>
                            <div class="slds-scrollable_x custom-table-container TrHoverBackGroundColorChange">
                                <table class="slds-table slds-table_cell-buffer slds-table_bordered custom-table">
                                <thead>
                                    <tr class="custom-header">
                                        <th scope="col" onclick={sortByField} data-field="LastName">
                                            <div class="slds-truncate" title="Last Name">Last Name
                                                <lightning-icon icon-name={sortIcon} alternative-text="Sort" size="x-small"
                                                    class="sort-icon"></lightning-icon>
                                            </div>
                                        </th>
                                        <th scope="col" onclick={sortByField} data-field="FirstName">
                                            <div class="slds-truncate" title="First Name">First Name
                                                <lightning-icon icon-name={sortIcon} alternative-text="Sort" size="x-small"
                                                    class="sort-icon"></lightning-icon>
                                            </div>
                                        </th>
                                        <th scope="col" onclick={sortByField} data-field="MiddleName">
                                            <div class="slds-truncate" title="Middle Name">Middle Name
                                                <lightning-icon icon-name={sortIcon} alternative-text="Sort" size="x-small"
                                                    class="sort-icon"></lightning-icon>
                                            </div>
                                        </th>
                                        <th scope="col" onclick={sortByField} data-field="MailingStreet">
                                            <div class="slds-truncate" title="MailingStreet">Address
                                                <lightning-icon icon-name={sortIcon} alternative-text="Sort" size="x-small"
                                                    class="sort-icon"></lightning-icon>
                                            </div>
                                        </th>
                                        <th scope="col" onclick={sortByField} data-field="Phone">
                                            <div class="slds-truncate" title="Phone">Phone
                                                <lightning-icon icon-name={sortIcon} alternative-text="Sort" size="x-small"
                                                    class="sort-icon"></lightning-icon>
                                            </div>
                                        </th>
                                        <th scope="col">
                                            <div class="slds-truncate actionMenu" title="Action">Action</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template if:true={isRecordsLoading}>
                                        <tr class="no-border-row">
                                            <td colspan="6" class="slds-text-align_center loader-row">
                                                <lightning-spinner alternative-text="Loading records..." variant="brand"
                                                    size="large"></lightning-spinner>
                                            </td>
                                        </tr>
                                    </template>
                                    <template if:false={isRecordsLoading}>
                                        <template for:each={paginatedResult} for:item="row">
                                            <tr key={row.Id} class="custom-column">
                                                <td>
                                                    <div class="slds-truncate" title={row.LastName}>{row.LastName}
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="slds-truncate" title={row.FirstName}>{row.FirstName}
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="slds-truncate" title={row.MiddleName}>{row.MiddleName}</div>
                                                </td>
                                                <td>
                                                    <div class="slds-truncate" title={row.formattedAddress}>
                                                        {row.formattedAddress}
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="slds-truncate" title={row.Phone}>{row.Phone}
                                                    </div>
                                                </td>
        
                                                <td>
                                                    
        
                                                    <lightning-button-menu alternative-text="Actions"
                                                        class="slds-button_icon slds-button_icon-inverse custom-button-menu"
                                                        variant="bare" icon-name="utility:threedots_vertical"
                                                        onselect={handleAction} menu-alignment="auto" data-id={row.Id}>
                                                        <lightning-menu-item label="View" variant="base"
                                                            value="view_request"></lightning-menu-item>
                                                        <lightning-menu-item label="Edit" variant="base"
                                                            value="edit_request"></lightning-menu-item>
                                                    </lightning-button-menu>
                                                </td>
                                            </tr>
                                        </template>
                                    </template>
                                </tbody>
                            </table>
                        </div>
    
                        <template if:true={showPages}>
                                <div class="pagination-container">
                                            <lightning-button class="pagination-button" label="<< Prev"
                                                onclick={handlePreviousPage} disabled={isPreviousDisabled}
                                                variant="neutral">
                                            </lightning-button>
    
                                            <div class="page-info">
                                                <span class="page-range">{startRecord}-{endRecord} of {totalRecords} &nbsp;</span>
                                                <span class="page-text"> | Page  &nbsp;
                                                    <lightning-input 
                                                    type="number" 
                                                    value={currentPage} 
                                                    label="Current Page" 
                                                    variant="label-hidden"
                                                    class="current-page-input"
                                                    onchange={handlePageChange}>
                                                </lightning-input> &nbsp;
                                                of {totalPages}
                                            </span>
                                            </div>
    
                                            <lightning-button class="pagination-button" label="Next >>"
                                                onclick={handleNextPage} disabled={isNextDisabled} variant="neutral">
                                            </lightning-button>
                                    
                                </div>
                            </template>
                        </template>
                        <template if:false={recordCount}>
                            <p class="no-data-message">No Attorney Inspector found matching the criteria</p>
                        </template>
                    </div>
                </template>
                
            </div>

        </div>
    </lightning-card>
</template>