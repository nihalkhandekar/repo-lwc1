<template>
    <template if:true={isLoading}>
        <div class="spinner-container">
            <lightning-spinner alternative-text="Loading..." variant="brand" size="large"></lightning-spinner>
        </div>
    </template>
    <template if:false={isLoading}>
        <div class="SE-ModalHeaderMain">
            <div>
                <lightning-button-icon icon-name="utility:back" size="large" alternative-text="go Back"
                    onclick={cloeModels} class="custom-modal__back">
                </lightning-button-icon>
                <div class="SE-ModalHeaderTitle" style="margin-left: 40px;">
                    <h2>{headerText}</h2>
                </div>
            </div>
            <div>
                <template if:true={isReadOnly}>
                    <lightning-button icon-name="utility:edit" alternative-text="Edit" class="edit-button"
                        onclick={handleEditClick} title="Edit" variant="base" aria-label="Edit"
                        label="Edit"></lightning-button>
                </template>
            </div>
        </div>

        <div class="SE-ModalHeader">
            <div class="custom-modal-body modalBodyCssChange">
                <div class="SE-modalFormStack">
                    <div class="SE-modalFormStackSection">
                        <div class="personal-info-section">
                            <div
                                class="SE-modalFormStackSectionHeader slds-media slds-media_center slds-m-bottom_medium info-sections">
                                <div class="slds-media__figure">
                                    <lightning-icon icon-name="standard:user" size="medium"></lightning-icon>
                                </div>
                                <div class="slds-media__body">
                                    <h2 class="slds-text-heading_small">Personal Information</h2>
                                    <p class="slds-text-body_small">Enter personal information to use state arms/seal.
                                    </p>
                                </div>
                            </div>

                            <div class="SE-modalFormStackSectionContent">
                                <div class="slds-grid slds-gutters slds-wrap">
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-combobox label="Prefix" name="prefix" placeholder="Select prefix"
                                            options={prefixOptions} value={formData.prefix} disabled={isReadOnly}
                                            onchange={handleInputChange}
                                            class="SE-notvalidate comboboxItemBackgroundColorChange">
                                        </lightning-combobox>
                                    </div>
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-input label="Last Name"
                                            message-when-pattern-mismatch="Last name can only contain letters"
                                            pattern="[A-Za-zÀ-ÖØ-öø-ÿ'-. ]+" name="lastName" disabled={isReadOnly}
                                            required value={formData.lastName} class="SE-searchCardInputLabel"
                                            onchange={handleInputChange}></lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-input label="Middle Initial" name="middleInitial"
                                            disabled={isReadOnly}
                                            message-when-pattern-mismatch="Middle initial can only be letters"
                                            pattern="^[A-Za-z]+(\.[A-Za-z]+)*\.?$" value={formData.middleInitial}
                                            onchange={handleInputChange}
                                            class="SE-searchCardInputLabel"></lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-input label="First Name" name="firstName"
                                            message-when-pattern-mismatch="First name can only contain letters"
                                            pattern="[A-Za-zÀ-ÖØ-öø-ÿ'-. ]+" disabled={isReadOnly} required
                                            value={formData.firstName} class="SE-searchCardInputLabel"
                                            onchange={handleInputChange}></lightning-input>
                                    </div>

                                </div>

                                <div class="slds-grid slds-gutters slds-wrap slds-m-top_medium">
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-combobox label="Suffix" name="suffix" placeholder="Select suffix"
                                            options={suffixOptions} value={formData.suffix} disabled={isReadOnly}
                                            onchange={handleInputChange}
                                            class="SE-notvalidate comboboxItemBackgroundColorChange">
                                        </lightning-combobox>
                                    </div>
                                    <!-- <div class="slds-col slds-size_1-of-4">
                                        <lightning-input label="Date of Birth" date-style="short" name="dob"
                                            disabled={isReadOnly} type="date" required placeholder="mm/dd/yyyy"
                                            value={formData.dob} max={maxDate} onchange={handleInputChange}
                                            class="SE-notvalidate SE-searchCardInputLabel"></lightning-input>
                                    </div> -->
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-input label="Phone Number" name="phoneNumber" maxlength="14"
                                            minlength="14" message-when-too-short="Please enter 10 digits Phone Number"
                                            onkeydown={handleKeyPress} disabled={isReadOnly} type="tel"
                                            value={formData.phoneNumber} onchange={handleInputChange}
                                            class="SE-notvalidate SE-searchCardInputLabel"></lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-4  esq-align">
                                        <lightning-input type="checkbox" label="Esq." name="esq" disabled={isReadOnly}
                                            checked={formData.esq} class="SE-notvalidate"
                                            onchange={handleInputChange}></lightning-input>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="slds-grid slds-gutters slds-wrap slds-m-top_medium">
                        <div class="slds-col slds-size_1-of-4">
                            <lightning-input label="Email" name="email" type="email"
                             disabled={isReadOnly} required class="SE-notvalidate SE-searchCardInputLabel"
                                value={formData.email} onchange={handleInputChange}></lightning-input>
                        </div>
                        <div class="slds-col slds-size_1-of-4">
                            <lightning-input label="Phone Number" name="phoneNumber" maxlength="14" minlength = "14" message-when-too-short="Please enter 10 digits Phone Number"
                                onkeydown={handleKeyPress} disabled={isReadOnly} type="tel" value={formData.phoneNumber}
                                onchange={handleInputChange} class="SE-notvalidate SE-searchCardInputLabel"></lightning-input>
                        </div>
                        <div class="slds-col slds-size_1-of-4 slds-align-bottom esq-align">
                            <lightning-input type="checkbox" label="Esq." name="esq" disabled={isReadOnly}
                                checked={formData.esq} class="SE-notvalidate" onchange={handleInputChange}></lightning-input>
                        </div>
                    </div> -->
                        </div>
                    </div>

                    <div class="SE-modalFormStackSection">
                        <!-- <div class="slds-box slds-theme_shade slds-m-top_medium"> -->
                        <div class="address-info-section">
                            <div
                                class="SE-modalFormStackSectionHeader slds-media slds-media_center slds-m-bottom_medium info-sections">
                                <div class="slds-media__figure">
                                    <lightning-icon icon-name="standard:service_territory_member"
                                        size="medium"></lightning-icon>
                                </div>
                                <div class="slds-media__body">
                                    <h2 class="slds-text-heading_small">Address Details</h2>
                                    <p class="slds-text-body_small">Enter address details to proceed further.</p>
                                </div>
                            </div>

                            <div class="SE-modalFormStackSectionContent">
                                <div class="slds-grid slds-gutters slds-wrap">
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-input label="Email" name="email" type="email" disabled={isReadOnly}
                                            required class="SE-notvalidate SE-searchCardInputLabel"
                                            value={formData.email} onchange={handleInputChange}></lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-input label="Title"
                                            message-when-pattern-mismatch="Title can only contain letters" name="title"
                                            disabled={isReadOnly} value={formData.title} class="SE-searchCardInputLabel"
                                            onchange={handleInputChange}></lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-input label="Entity"
                                            message-when-pattern-mismatch="Entity can only contain letters"
                                            name="entity" disabled={isReadOnly} value={formData.entity}
                                            class="SE-searchCardInputLabel"
                                            onchange={handleInputChange}></lightning-input>
                                    </div>
                                </div>

                                <div class="form-group full-width slds-form-element_compound slds-form-element">
                                    <template if:true={isReadOnly}>
                                        <lightning-input-address class='address'
                                            address-lookup-placeholder="Search country, city, state, street...."
                                            message-when-pattern-mismatch="Please Enter Address"
                                            street={formData.address1} street-label="Address Line 1"
                                            subpremise={formData.address2}
                                            subpremise-placeholder="e.g., Apt 4B, Suite 200, 2nd Floor"
                                            subpremise-label="Suite/Apartment/Floor" city-label="City"
                                            city={formData.city} province-label="State" province={formData.state}
                                            postal-code={formData.zipCode} postal-code-label="Zip Code"
                                            country-label="Country" country={formData.country}
                                            onchange={handleAddressChange} show-compact-address disabled required>
                                        </lightning-input-address>
                                    </template>
                                    <template if:false={isReadOnly}>
                                        <lightning-input-address class='address SE-searchCardInputLabel'
                                            address-lookup-placeholder="Search country, city, state, street...."
                                            message-when-pattern-mismatch="Please Enter Address"
                                            street={formData.address1} street-label="Address Line 1"
                                            subpremise={formData.address2}
                                            subpremise-placeholder="e.g., Apt 4B, Suite 200, 2nd Floor"
                                            subpremise-label="Suite/Apartment/Floor" city-label="City"
                                            city={formData.city} province-label="State" province={formData.state}
                                            postal-code={formData.zipCode} postal-code-label="Zip Code"
                                            country-label="Country" country={formData.country}
                                            onchange={handleAddressChange} show-address-lookup show-compact-address
                                            required>
                                        </lightning-input-address>
                                    </template>
                                    <p if:true={validationError} class="slds-text-color_error">{validationError}</p>
                                </div>
                            </div>

                        </div>
                    </div>


                    <div class="SE-modalFormStackSection">
                        <div class="sots-info-section">
                            <div
                                class=" SE-modalFormStackSectionHeader slds-media slds-media_center slds-m-bottom_medium info-sections">
                                <div class="slds-media__figure">
                                    <lightning-icon icon-name="action:update_status" size="x-small"></lightning-icon>
                                </div>
                                <div class="slds-media__body">
                                    <h2 class="slds-text-heading_small">For SOTS Use (ONLY)</h2>
                                    <p class="slds-text-body_small">This are the details related to SOTS use only.</p>
                                </div>
                            </div>
                            <div class="SE-modalFormStackSectionContent">

                                <div class="slds-grid slds-gutters slds-wrap">
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-textarea label="Letter Text"
                                            message-when-pattern-mismatch="PLease Enter Letter Text"
                                            disabled={isReadOnly} name="letterText" required value={formData.letterText}
                                            onchange={handleInputChange}
                                            class="SE-notvalidate SE-searchCardInputLabel"></lightning-textarea>
                                    </div>
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-textarea label="Enclosure" disabled={isReadOnly} name="enclosure"
                                            value={formData.enclosure} class="SE-notvalidate"
                                            onchange={handleInputChange}></lightning-textarea>
                                    </div>
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-textarea label="Proposed Use" disabled={isReadOnly}
                                            name="proposedUse" value={formData.proposedUse} class="SE-notvalidate"
                                            onchange={handleInputChange}></lightning-textarea>
                                    </div>
                                </div>

                                <div class="slds-grid slds-gutters slds-wrap slds-m-top_medium">
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-combobox label="Requested For" name="requestedFor"
                                            placeholder="Select Requested For" disabled={isReadOnly}
                                            options={requestedForOptions}
                                            class="SE-notvalidate comboboxItemBackgroundColorChange"
                                            value={formData.requestedFor} onchange={handleInputChange}>
                                        </lightning-combobox>
                                    </div>
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-combobox label="Disposition" name="disposition"
                                            placeholder="Select Disposition" disabled={isReadOnly}
                                            options={dispositionOptions}
                                            class="SE-notvalidate comboboxItemBackgroundColorChange"
                                            value={formData.disposition} onchange={handleInputChange}>
                                        </lightning-combobox>
                                    </div>
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-combobox label="Approved For" name="approvedFor"
                                            placeholder="Select Approved For" disabled={isReadOnly}
                                            options={approvedForOptions} value={formData.approvedFor}
                                            onchange={handleInputChange}
                                            class="SE-notvalidate comboboxItemBackgroundColorChange">
                                        </lightning-combobox>
                                    </div>
                                    <div class="slds-col slds-size_1-of-4">
                                        <lightning-input label="Date of SOTS Response" disabled={isReadOnly}
                                            name="dateOfResponse" date-style="short" required type="date"
                                            placeholder="mm/dd/yyyy" value={formData.dateOfResponse}
                                            class="SE-searchCardInputLabel" onchange={handleInputChange}></lightning-input>
                                    </div>
                                </div>

                                <div class="slds-grid slds-gutters slds-wrap slds-m-top_medium">

                                    <div class="slds-col slds-size_1-of-1 reason-inline">
                                        <label class="boldFont">Reason</label>
                                        <lightning-radio-group name="reason" variant="label-hidden"
                                            disabled={isReadOnly} label="Reason" options={reasonOptions}
                                            class="SE-notvalidate" value={formData.reason} onchange={handleInputChange}
                                            required>
                                        </lightning-radio-group>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>


                    <div class="SE-modalFormStackSection">
                        <template if:true={isGenerateLetterSectionEnabled}>
                            <div class="generate-info-section">
                                <div
                                    class=" SE-modalFormStackSectionHeader slds-media slds-media_center slds-m-bottom_medium info-sections">
                                    <div class="slds-media__figure">
                                        <lightning-icon icon-name="standard:letterhead" size="medium"></lightning-icon>
                                    </div>
                                    <div class="slds-media__body">
                                        <h2 class="slds-text-heading_small">Generate Letter</h2>
                                        <p class="slds-text-body_small">Enter the details for the letter.</p>
                                    </div>
                                </div>

                                <div class="SE-modalFormStackSectionContent">
                                    <div class="slds-grid slds-gutters slds-wrap">
                                        <div class="slds-col slds-size_1-of-3 combobox-container">
                                            <lightning-combobox 
                                            label="Signed By" 
                                            name="signedBy"
                                            placeholder="Select Signed By" 
                                            options={signedByOptions} 
                                            required
                                            disabled={isReadOnly} 
                                            value={formData.signedBy}
                                            onchange={handleInputChange}
                                            class="SE-searchCardInputLabel comboboxItemBackgroundColorChange">
                                        </lightning-combobox>
                                        </div>
                                        <div class="slds-col slds-size_1-of-3 combobox-container">
                                            <lightning-combobox 
                                            label="Letter Type" 
                                            name="letterType"
                                            placeholder="Select Letter Type" 
                                            options={letterTypeOptions}
                                            required={letterTypeNR} 
                                            disabled={isReadOnly}
                                            value={formData.letterType}
                                            onchange={handleInputChange}
                                            class="SE-searchCardInputLabel comboboxItemBackgroundColorChange">
                                        </lightning-combobox>
                                        </div>
                                        <div class="slds-col slds-size_1-of-3 wetsign-inline">
                                            <label class="boldFont">Wet Signature</label>
                                            <lightning-radio-group name="wetSign" label="Wet Signature"
                                                options={wetSignOptions} disabled={isReadOnly} variant="label-hidden"
                                                value={formData.wetSign} onchange={handleInputChange}
                                                class="SE-searchCardInputLabel comboboxItemBackgroundColorChange" required>
                                            </lightning-radio-group>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div> 

        <div class="footer">
            <div class='slds-button-group'>
                <div class="button-left-group">
                    <lightning-button label="Print Envelope" variant="neutral" class="button-spacing print-buttons"
                        onclick={handlePrintEnvelope} disabled={isPrintEnabled}></lightning-button>
                    <lightning-button label="Print Letter" variant="neutral" class="button-spacing print-buttons"
                        onclick={handlePrintLetter} disabled={isPrintEnabled}></lightning-button>
                    <lightning-button label="Send Email" variant="neutral" class="button-spacing print-buttons"
                        onclick={handleSendEmail} disabled={isPrintEnabled}></lightning-button>
                </div>
                <div class="button-right-group">
                    <lightning-button label="Cancel" variant="base" onclick={cloeModels}
                        class="slds-m-right_x-small clear-font"></lightning-button>
                    <lightning-button variant="brand" label="Save" disabled={isReadOnly} class="save-button"
                        onclick={handleAdd}></lightning-button>
                </div>
            </div>
        </div>

        <!-- Include the sap_PdfGenerator child component -->
        <c-sap_-pdf-generator></c-sap_-pdf-generator> <!-- Assuming sap_PdfGenerator is the child LWC -->
        <c-sap_-toast-message-state-modal></c-sap_-toast-message-state-modal>

    </template>
</template>