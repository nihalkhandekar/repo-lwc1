<!--*********************************************************************************************
 * NAME:  qnAQuestionInput.cmp
 * DESCRIPTION: Renders a single question and recursively iterates all the child questions 
 *
 * @AUTHOR: Piyush Jogdand
 * @DATE: 19/03/2020
 *
 *
 * MODIFICATION LOG:
 * DEVELOPER                         DATE                               DESCRIPTION
 * _____________________________________________________________________________________________
 * Piyush Jogdand                     19/03/2020                         Created the first version
 * Pooja Dubey						  25/04/2020						 CTBOS-377. Updated framework logic
*********************************************************************************************-->
<template>
  <!--Parent Question block-->
  <div if:true={visible} class="wrapper">
    <div class={flowwrapper}>
      <div if:true={spinner}>{label.loadingText}...</div>
      <lightning-layout class="align slds-wrap">
        <lightning-layout-item
          class="slds-medium-size_12-of-12 slds-large-size_7-of-12 questionContainer"
        >
          <lightning-layout-item
            class="qInput"
            aria-label={question.questionBody}
          >
            <div if:true={haserror} class="slds-text-color_error">
              {errorMessage}
            </div>
            <h4 class="Question"
              aria-label={question.questionBody}
              tabindex="0"
            >{question.questionBody}</h4>
          </lightning-layout-item>
          <div class="helpTextContainer_mob">
            <!-- Div for label More Information in Mobile -->
            <div class="toolTip" onclick={showDiv}>
              <a href="#info" class="infoLink">{label.helpMeAnswer}</a>
              <template if:false={showHelp}>
                <lightning-icon
                  icon-name="utility:chevrondown"
                  size="xx-small"
                  alternative-text="chevrondown"
                  title="chevrondown"
                  class="chevron-container-down"
                ></lightning-icon>
              </template>
              <template if:true={showHelp}>
                <lightning-icon
                  icon-name="utility:chevronup"
                  size="xx-small"
                  alternative-text="chevronup"
                  title="chevronup"
                  class="chevron-container-up"
                ></lightning-icon>
              </template>
            </div>
            <!-- Div for Content of More Information in Mobile -->
            <template if:true={showHelp}>
              <div if:false={separatequestions}>
                <div class="helpTextContent">
                  <c-qn-a_-subsection-help-text
                    helptextstatic={helptextdetails.subsectionHelpTextStatic}
                    helptextlinklabel={helptextdetails.subsectionHelpTextLinkLabels}
                    helptextlinkurls={helptextdetails.subsectionHelpTextLinkUrls}
                    questionid={question.id}
                    response={response}
                    sectiontitle={title}
                  ></c-qn-a_-subsection-help-text>
                </div>
              </div>
              <div if:true={separatequestions}>
                <div class="helpTextContent">
                  <c-qn-a_-subsection-help-text
                    helptextstatic={question.subsectionHelpTextStatic}
                    helptextlinklabel={question.subsectionHelpTextLinkLabels}
                    helptextlinkurls={question.subsectionHelpTextLinkUrls}
                    questionid={question.id}
                    response={response}
                    sectiontitle={title}
                  ></c-qn-a_-subsection-help-text>
                </div>
              </div>
            </template>
          </div>
          <div if:true={showQuestionHelpText}>
            <c-qn-a_-question-help-text
              helptextnotes={question.headingHelpTextNotes}
              headinghelptext={question.headingHelpText}
              questionid={question.id}
            >
            </c-qn-a_-question-help-text>
          </div>
          <lightning-layout-item class="QuestionInput">
            <!--TODO: Generate component dynamically if there too many types-->

            <div if:true={question.isRequired}>
              <div if:true={showRadioGroup}>
                <div class="radio-option">
                  <c-generic-radio-input
                    qid={showRadioName}
                    radio-options={options}
                    name={question.id}
                    answer={answer}
                    required={question.isRequired}
                    onctbosdatachange={handleRadioClick}
                  ></c-generic-radio-input>
                </div>
              </div>
              <div if:true={showCheckBox}>
                <c-generic-multi-select
                  list-data={options}
                  name={question.id}
                  value={answer}
                  required={question.isRequired}
                  oncheckboxinputselection={handlecheckboxResult}
                  isbos={checkifbos}
                ></c-generic-multi-select>
              </div>
              <lightning-combobox
                if:true={showComboBox}
                placeholder="Choose Status"
                value={answer}
                onchange={onAnswerChange}
                options={options}
                readonly={readonly}
                variant="label-hidden"
                required
              >
              </lightning-combobox>
              <lightning-input
                type={question.datatype}
                if:true={showInput}
                variant="label-hidden"
                value={answer}
                required
                onchange={onAnswerChange}
                onblur={checkAnswerValidity}
                readonly={readonly}
                class="text slds-icon_container"
                checked
                placeholder={placeHolderInput}
                max-length="100"
              >
              </lightning-input>

              <div if:true={showInput} class="inputCharLimit">
                <span if:true={showCharLimit}> {inputCharLimit}</span>
              </div>
              <lightning-dual-listbox
                name="quesMultiSelect"
                if:true={showMultiSelect}
                value={answer}
                source-label="Available"
                selected-label="Selected"
                options={options}
                min="1"
                onchange={onAnswerChange}
              >
              </lightning-dual-listbox>
              <div if:true={showInputSearch}>
                <c-generic-look-up
                  list-items={picklistOptions}
                  search-place-holder={searchPlaceHolder}
                  onsearchinputselection={handleSearchResult}
                  onsearchinputremove={handleSearchResult}
                  answer={answer}
                ></c-generic-look-up>
              </div>
              <div if:true={showCategorySearchBrowse}>
                <c-registration-requirement
                  selectedcategory={answer}
                  onselectedcategory={handleSelectedCategory}
                ></c-registration-requirement>
              </div>
            </div>
            <!-- if question is not marked as required -->
            <div if:false={question.isRequired}>
              <div if:true={showSearchBrowse}>
                <c-business-service
				  qid={showServiceName}
                  previousservice={answer}
                  onserviceselected={handleSelectedService}
                ></c-business-service>
              </div>
              <div if:true={showRadioGroup} class="radio-option">
                <c-generic-radio-input
                  qid={showRadioName}
                  value={answer}
                  radio-options={options}
                  name={question.id}
                  required={question.isRequired}
                  onctbosdatachange={handleRadioClick}
                ></c-generic-radio-input>
              </div>
              <div if:true={showCheckBox}>
                <c-generic-multi-select
                  list-data={options}
                  name={question.id}
                  value={answer}
                  required={question.isRequired}
                  oncheckboxinputselection={handlecheckboxResult}
                  isbos={checkifbos}
                ></c-generic-multi-select>
              </div>
              <lightning-combobox
                if:true={showComboBox}
                placeholder="Choose Status"
                value={answer}
                onchange={onAnswerChange}
                options={question.options}
                readonly={readonly}
                variant="label-hidden"
              >
              </lightning-combobox>
              <lightning-input
                type={question.datatype}
                if:true={showInput}
                variant="label-hidden"
                value={answer}
                label="Red"
                onchange={onAnswerChange}
                readonly={readonly}
                class="text"
                checked
              >
              </lightning-input>
              <lightning-dual-listbox
                name="quesMultiSelect"
                if:true={showMultiSelect}
                value={answer}
                source-label="Available"
                selected-label="Selected"
                options={question.options}
                onchange={onAnswerChange}
              >
              </lightning-dual-listbox>

              <div if:true={showInputSearch}>
                <c-generic-look-up
                  list-items={picklistOptions}
                  search-place-holder={searchPlaceHolder}
                  onsearchinputselection={handleSearchResult}
                  onsearchinputremove={handleSearchResult}
                  answer={answer}
                ></c-generic-look-up>
              </div>
              <div if:true={showCategorySearchBrowse}>
                <c-registration-requirement
                  selectedcategory={answer}
                  onselectedcategory={handleSelectedCategory}
                ></c-registration-requirement>
              </div>
            </div>
          </lightning-layout-item>
        </lightning-layout-item>
        <!-- New styling for helptext-->
        <div
          class="slds-medium-size_1-of-12 slds-large-size_1-of-12 emptyContainer"
        ></div>
        <lightning-layout-item
          class="slds-medium-size_4-of-12 slds-large-size_4-of-12 helpTextContainer"
        >
          <!-- displaying helptext at Question Level -->
          <div class="helpTextSec">
            <div if:false={separatequestions}>
              <div class="helpTextContent">
                <c-qn-a_-subsection-help-text
                  helptextstatic={helptextdetails.subsectionHelpTextStatic}
                  helptextlinklabel={helptextdetails.subsectionHelpTextLinkLabels}
                  helptextlinkurls={helptextdetails.subsectionHelpTextLinkUrls}
                  questionid={question.id}
                  response={response}
                  sectiontitle={title}
                ></c-qn-a_-subsection-help-text>
              </div>
            </div>
            <div if:true={separatequestions}>
              <div class="helpTextContent">
                <c-qn-a_-subsection-help-text
                  helptextstatic={question.subsectionHelpTextStatic}
                  helptextlinklabel={question.subsectionHelpTextLinkLabels}
                  helptextlinkurls={question.subsectionHelpTextLinkUrls}
                  questionid={question.id}
                  response={response}
                  sectiontitle={title}
                ></c-qn-a_-subsection-help-text>
              </div>
            </div>
          </div>
        </lightning-layout-item>
      </lightning-layout>
      <!--/div-->
    </div>
  </div>
</template>