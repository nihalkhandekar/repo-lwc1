<template>
    <lightning-card>
            <div class="SE-content">
                <div class="SE-Card secondDivForSearching">
                    <div class="slds-grid slds-grid_align-end slds-m-bottom_medium">
                        <div class="buttoncontainerfilter">
                            <div class="left-button slds-p-left_small">
                                <span class="slds-text-title_bold slds-m-right_x-small search-css">Search Results</span>
                                <lightning-badge label={recordsFound}
                                    class="slds-badge_inverse result-no-css"></lightning-badge>
                            </div>
                            <div class="right-buttons">
                                <div class="export-button" title="Export to Excel" onclick={handleExportResultButtonClick}>
                                    <lightning-icon icon-name="doctype:excel" size="xx-small" alternative-text="Excel Icon"></lightning-icon>
                                    <span>Export to Excel</span>
                                </div>
                                <lightning-button icon-name="utility:download" variant="brand" label="Download PDF"
                                    onclick={handleDownloadPdf} class="customButton slds-m-left_small">
                                </lightning-button>
                            </div>
                        </div>
                    </div>
                
                    <template if:true={isrecordFound}>
                        <div class="slds-scrollable_x custom-table-wrapper">
                            <table class="slds-table slds-table_cell-buffer slds-table_bordered custom-table">
                                <thead>
                                    <tr class="custom-header">
                                        <th scope="col" data-field="Customer__c" class={sortedClassCustomer} onclick={handleSort}>
                                            <div class="slds-truncate">
                                                Customer ID
                                                <lightning-icon icon-name={sortIcons.Customer__c}   class="sort-icon"
                                        size="x-small"></lightning-icon>
                                            </div>
                                        </th>
                                        <th scope="col" data-field="Name" class={sortedClassName} onclick={handleSort}>
                                            <div class="slds-truncate">
                                                Name
                                                <lightning-icon icon-name={sortIcons.Name}   class="sort-icon"
                                        size="x-small"></lightning-icon>
                                            </div>
                                        </th>
                                        <th scope="col">
                                            <div class="slds-truncate">
                                                1-30 Days
                                            </div>
                                        </th>
                                        <th scope="col">
                                            <div class="slds-truncate">
                                                31-60 Days
                                            </div>
                                        </th>
                                        <th scope="col">
                                            <div class="slds-truncate">
                                                61-90 Days
                                            </div>
                                        </th>
                                        <th scope="col">
                                            <div class="slds-truncate">
                                                91-120 Days
                                            </div>
                                        </th>
                                        <th scope="col">
                                            <div class="slds-truncate">
                                                120+ Days
                                            </div>
                                        </th>
                                        <th scope="col"  data-field="SAP_Customer_Account_Balance__c" class={sortedClassTotalBalance} onclick={handleSort} >
                                            <div class="slds-truncate">
                                                Total Balance
                                                <lightning-icon icon-name={sortIcons.SAP_Customer_Account_Balance__c}  class="sort-icon"
                                        size="x-small"></lightning-icon>
                                            </div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={agingReport} for:item="row">
                                        <tr key={row.CustomerId} class={row.className}>
                                            <td>
                                                <div class="slds-truncate" title={row.CustomerID}>{row.CustomerID}</div>
                                            </td>
                                            <td>
                                                <div class="slds-truncate" title={row.Name}>{row.Name}</div>
                                            </td>
                                            <td>
                                                <div class="slds-truncate" title={row.oneDay}>{row.oneDay}</div>
                                            </td>
                                            <td>
                                                <div class="slds-truncate" title={row.thirtyDays}>{row.thirtyDays}</div>
                                            </td>
                                            <td>
                                                <div class="slds-truncate" title={row.sixtyDays}>{row.sixtyDays}</div>
                                            </td>
                                            <td>
                                                <div class="slds-truncate" title={row.ninetyDays}>{row.ninetyDays}</div>
                                            </td>
                                            <td>
                                                <div class="slds-truncate" title={row.oneTwentyPlusDays}>{row.oneTwentyPlusDays}</div>
                                            </td>
                                            <td>
                                                <div class="slds-truncate" title={row.TotalBalance}>{row.TotalBalance}</div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                    </template>
                    <template if:true={isRecordsLoading}>
                        <div class="slds-text-align_center loader-row">
                            <lightning-spinner alternative-text="Loading records..." variant="brand" size="large"></lightning-spinner>
                        </div>
                    </template>

                    <template if:false={isrecordFound}>
                        <div class="no-result-found">
                            <h1 class="no-result-found-label">No Results Found</h1>
                        </div>
                    </template>

                    <div class="pagination-container">
                        <lightning-button class="pagination-button" label="<< Prev" onclick={handlePreviousPage}
                            disabled={isPreviousDisabled} variant="neutral">
                        </lightning-button>
    
                        <div class="page-info">
                            <span class="page-range">{startRange}-{endRange} of {recordsFound}</span>
                            <span class="page-text"> | Page {currentPage} of {totalPages}</span>
                        </div>
    
                        <lightning-button class="pagination-button" label="Next >>" onclick={handleNextPage}
                            disabled={isNextDisabled} variant="neutral">
                        </lightning-button>
                    </div>
                </div>
            </div>

    </lightning-card>
    <c-sap_-finsys-export-to-excel></c-sap_-finsys-export-to-excel>
    <c-sap_-finsys-reports-pdf-generator></c-sap_-finsys-reports-pdf-generator>

    
</template>