<template>
    <lightning-modal-header class="SE-ModalHeader">
        <div class="SE-ModalHeaderTitle">
            <h2>Print Payment Receipt</h2>
        </div>
        <lightning-button-icon icon-name="utility:close" size="large" alternative-text="Close" onclick={closeModels} class="custom-modal__close">
        </lightning-button-icon>
    </lightning-modal-header>

    <!-- Show loader while data is loading -->
    <template if:true={isLoading}>
        <lightning-modal-body>
            <lightning-spinner alternative-text="Loading..." size="large" variant="base"></lightning-spinner>
        </lightning-modal-body>
    </template>

    <!-- Show modal content once data is loaded -->
    <template if:false={isLoading}>
        <lightning-modal-body>
            <!-- Iterate over transaction records -->
            <template for:each={records} for:item="record">
                <div key={record.id} class="transaction-container">
                    <div class="vertical-text">
                        <p class="modal-text work-order">Work Order#: </p> {record.workOrder}
                    </div>
                    <div class="vertical-text">
                        <p class="modal-text total-amount">Amount Paid: </p> {record.totalAmountPaid}
                    </div>
                    <div class="vertical-text">
                        <p class="modal-text">Payment Method: </p> {record.paymentMethod}
                    </div>
                    <div class="vertical-text">
                        <p class="modal-text">Auth Code: </p> {record.authCode}
                    </div>
                    <div class="vertical-text">
                        <p class="modal-text">Date of Payment: </p> {record.dateOfPayment}
                    </div>
                    <hr class="separator"/> <!-- Separator between transactions -->
                </div>
            </template>
        </lightning-modal-body>
        
    </template>

    <lightning-modal-footer class="SE-modalFooter">
        <div class="slds-button-group">
            <div class="button-left-group">
                <lightning-button label="Send Payment Receipt via email" variant="neutral" class="button-spacing print-buttons" onclick={handleSendEmail}></lightning-button>
            </div>
            
            <div class="button-right-group SE-modalFooterButtonGroup">
                <button class="slds-button SE-borderLessButton" onclick={closeModels}>Cancel</button>
                <lightning-button variant="brand" label="Print Payment Receipt" class="save-button" onclick={handlePrint}></lightning-button>
            </div>
        </div>
    </lightning-modal-footer>
    <c-sap_-toast-message-state-modal></c-sap_-toast-message-state-modal>

    <!-- Your PDF Generator child component -->
    <c-sap_-pdf-genrator data-id="pdfGenerator" records={records} documents-requested={documentsRequested}
    total-fee={totalFee} expedite-fee={expediteFee}></c-sap_-pdf-genrator>
</template>