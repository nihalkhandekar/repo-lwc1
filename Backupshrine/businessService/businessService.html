<template>

    <!-- display the selected business item from the list -->
    <template if:true={showResult}>
      <div class="resultContainer">
        <template for:each={selectedArray} for:item="item">
          <div key={item.id} class="SelectItemContainer">
            <div class="content" tabindex="0">{item.name}</div>
            <div class="close">
              <div
              	class="closeDiv tabfocus"
                id={item.id}
                tabindex="0"
                onclick={handleClose}
              	onkeypress={handleClose}
              >
                <img
                  src={closeIcon}
                  class="closeIcon"
                  alt="closeIcon"
                  tabindex="0"
                  id={item.id}
                />
              </div>
            </div>
          </div>
        </template>
        <button
          if:true={showAddNewButton}
        	class="slds-button add-button tabfocus"
          	onclick={handleNewComp}
        >
          {label.label_addAnotherService}
        </button>
      </div>
    </template>
    <!-- search and browse tabs -->
    <template if:true={showTabs}>
      <div class="wrapper">
        <lightning-tabset
          class="tab"
          role="tablist"
        >
          <lightning-tab label={label.label_browse} value={browseUniqueVal} role="tab" onactive={handleActive}>
            <ul class="browse-container">
              <nav
                if:true={showNav}
                role="navigation"
                aria-label="Breadcrumbs"
                class="breadcrumb_wrapper"
              >
                <ol class="slds-breadcrumb slds-list_horizontal slds-wrap">
                  <template for:each={breadcrumVal} for:item="selectedItem">
                    <li
                      class="breadcrumb tabfocus"
                      key={selectedItem.level}
                      id={selectedItem.level}
                      value={selectedItem.level}
                      onclick={updateLevel}
                      onkeypress={updateLevel}
                      title={selectedItem.header}
                      tabindex="0"
                    >
                      <img
                        src={chevronRight}
                        key={selectedItem.level}
                        class="chevronRight"
                        alt="chevronRight"
                      />
                      <a class="breadcrumb-name">{selectedItem.header}</a>
                      <a class="ellipsis">...</a>
                    </li>
                  </template>
                </ol>
                <div class="category-name">
                  {target}
                </div>
              </nav>

              <template for:each={showCategories} for:item="category">
                <template if:false={topLevel}>
                  <li
                    key={category.ServiceTitle}
                    id={category.Id}
                    value={category.level}
                    title={category.ServiceTitle}
                    onclick={handleClick}
                    onkeypress={handleClick}
                    class="list-item tabfocus"
                    tabindex="0"
                  >
				  <div class="li-content">
                    <p class="large li-name">{category.ServiceTitle}</p>
                    <img
                      src={chevronRightGrey}
                      class="chevronright-icon"
                      alt="chevronRightGrey"
                      aria-hidden="true"
                    />
					</div>
					<div class="separator" key={category.Id}></div>
                  </li>
                </template>
                <template if:true={topLevel}>
                  <li
                    key={category.Id}
                    id={category.Id}
                    value={category.ServiceTitle}
                    onclick={handleCheckBusiness}
                    onkeypress={handleCheckBusiness}
                    class="list-item tabfocus"
                    title={category.ServiceTitle}
                    tabindex="0"
                  >
				   <div class="li-content">
                    <p class="large li-name">{category.ServiceTitle}</p>
                    <div class="radio">
                      <input
                        class="radio-custom"
                        name="radio-group"
                        type="radio"
                        checked={category.selected}
                        aria-hidden="true"
                      />
                      <span class="radio-custom-label">
                        <img
                          src={radioChecked}
                          class="radio-checked"
                          alt="radioChecked"
                          tabindex="0"
                        />
                        <img
                          src={radioUnchecked}
                          class="radio-unchecked"
                          alt="radioUnchecked"
                          aria-hidden="true"
                        />
                      </span>
                    </div>
					</div>
					<div class="separator" key={category.Id}></div>
                  </li>                 
                </template>
              </template>
            </ul>
            <template if:true={showError} class="error-container">
              <div class="error-msg-wrapper" role="alert">
                <section
                  aria-label="Error Message"
                  class="slds-popover slds-nubbin_top"
                  role="dialog"
                >
                  <div class="slds-popover__body error-msg">
                    <p class="small" tabindex="0" role="text">
                      {label.label_selectService}
                    </p>
                  </div>
                </section>
              </div>
            </template>
          </lightning-tab>
          <lightning-tab
            label={label.label_search}
            value={searchUniqueVal}
            class="search"
            role="tab"
			onactive={handleActive}
          >
            <div
              class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right search-box"
              role="combobox"
              aria-expanded="false"
              aria-owns="ex1-listbox"
              aria-haspopup="listbox"
              id="ex1-combobox"
              tabindex="0"
			        onmousedown={handleMouseClick}
              onkeydown={handleKeyDown}
			>
              <input
                type="text"
                placeholder={SearchPlaceholder}
                class="searchVal searchBox"
                onchange={handleSearchTermChange}
                onkeyup={handleSearchTermPress}
                value={inputValue}
                data-id="search-inputi12"
                aria-autocomplete="list"
                aria-controls="ex1-listbox"
                id="ex1-input"
                role="textbox"              
              />
              <span class="search-icon-wrapper" onclick={handleSearchTermChange}>
                <img
                  class="slds-m-right_small"
                  src={searchIcon}
                  alt="Search Icon"
                />
              </span>
            </div>
            <ul
              class="Hid lookup-option-container slds-p-horizontal_x-small slds-p-bottom_x-small Hide"
              role="listbox"
              id="ex1-listbox"          
		  >
              <template if:true={data}>
                <span class="results">{data.length} {label.searchResults} "{inputValue}" </span>
                <template for:each={data} for:item="Record">
                  <li
                    key={Record.id}
                    class="data-list"
                    data-files={Record.id}
					          id={Record.id}
                    data-id={Record.id}
                    onclick={populateValue}
                    onmousedown={populateValue}
					          role="option"
                    onkeydown={populateValueWithFocus}
                    onkeypress={populateValueWithFocus}
                  >
               
                    <lightning-formatted-rich-text value={Record.name}></lightning-formatted-rich-text>
                    <br>
                    <lightning-formatted-rich-text class="keywords" value={Record.keywords}></lightning-formatted-rich-text>

                    <p lwc:dom="manual" class="search-list-heading"></p>
                    <p lwc:dom="manual" class="search-list-text"></p>
                  </li>
                </template>
              </template>
              <template if:false={data.length}>
                <div class="data-list">
                  {label.label_noResults}
                </div>
              </template>
            </ul>
           <template if:true={showError} class="error-container">
              <div class="error-msg-wrapper" role="alert">
                <section
                  aria-label="Error Message"
                  class="slds-popover slds-nubbin_top"
                  role="dialog"
                >
                  <div class="slds-popover__body error-msg">
                    <p class="small" tabindex="0" role="text">
                      {label.label_selectFromDropdown}
                    </p>
                  </div>
                </section>
              </div>
            </template>
          </lightning-tab>
        </lightning-tabset>
      </div>
    </template>
    <template if:true={showDuplicateError} class="error-container">
      <div class="error-msg-wrapper" role="alert">
        <section
          aria-label="Error Message"
          class="slds-popover slds-nubbin_top"
          role="dialog"
        >
          <div class="slds-popover__body error-msg">
            <p class="small" tabindex="0" role="text">
              {label.label_serviceAlreadyAdded}
            </p>
          </div>
        </section>
      </div>
    </template>

</template>